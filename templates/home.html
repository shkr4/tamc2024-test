<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Doto:wght@100..900&family=Jaldi:wght@700
    &family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700
    &family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900
    &display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Student Detail</title>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/libphonenumber-js/1.11.14/libphonenumber-js.min.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script src="https://unpkg.com/validator@latest/validator.min.js"></script>
    <style>
        .jaldi-bold {
            font-family: "Jaldi", sans-serif;
            font-weight: 700;
            font-style: normal;
        }
        .ubuntu-medium {
            font-family: "Ubuntu", sans-serif;
            font-weight: 500;
            font-style: normal;
        }
        .lato-bold {
            font-family: "Lato", sans-serif;
            font-weight: 700;
            font-style: normal;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            font-family: "Ubuntu", sans-serif;
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
        /* Alternating row colors */
        tr:nth-child(even) {
            background-color: #F7F7F7;
        }
        tr:nth-child(odd) {
            background-color: #ffffff;
        }
        .form-container {
            width: 50%;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            box-shadow: 0px 0px 10px 0px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body style="background-color: #e7e5e5;">

    <div style="margin-top: 3%;" class="container">
        <h2 style="text-align: center; font-family: 'Ubuntu', sans-serif;">THAKURGANJ ANNUAL MATHEMATICS CONTEST ‚Äí \(11111101000_2 \)</h2>
        <p style="text-align: center;"><b>Organised by: <a href="https://rmctkg.wordpress.com/">Ramanujan Mathematics Club</a>, Thakurganj</b></p>
        <hr class="my-4">
    </div>

    <div class="container">
        <div style="border: 5px solid red; padding: 20px; align-self: center;">            
                <h5>‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§ï‡•á ‡§¶‡§ø‡§∂‡§æ-‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂:</h5>                
                <ul>
                    <li><p>
                        <small>
                            ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§π‡•Ä-‡§∏‡§π‡•Ä ‡§≠‡§∞‡•á‡§Ç‡•§<br>
                            Please fill all the information correctly.
                        </small>
                    </p>
                    </li>
                    
                    <li>
                        <p>
                            <small>
                                ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§®‡§æ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï ‡§ï‡§æ ‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§è‡§ï ‡§Ü‡§ß‡§æ‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§° ‡§∏‡•á ‡§è‡§ï ‡§π‡•Ä ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§<br>
                                If the student does not have an Aadhaar card, enter the Aadhaar number of the guardian. Only one student can be registered with one Aadhaar card.
                            </small>
                        </p>
                    </li>
                    
                    <li style="color: red;">
                        <p><small><b>‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§ó ‡§≤‡•á‡§®‡•á ‡§ï‡§æ ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§ï‡§ï‡•ç‡§∑‡§æ 6 ‡§ï‡•á ‡§≤‡§ø‡§è ‚Çπ0 ‡§π‡•à ‡§î‡§∞ ‡§Ö‡§®‡•ç‡§Ø ‡§ï‡•á ‡§≤‡§ø‡§è ‚Çπ20 ‡§π‡•à‡•§ ‡§Ø‡§π ‡§≤‡§ò‡•Å ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§Ö‡§µ‡§æ‡§Ç‡§õ‡§ø‡§§ ‡§ï‡§æ‡§∞‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§õ‡§æ‡§Å‡§ü‡§®‡•á ‡§≤‡§ø‡§è ‡§≤‡§ó‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§µ‡§æ‡§™‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§<br>                                  
                        The fee for appearing in the exam is ‚Çπ0 for Class 6 and ‚Çπ20 for others. This small fee is being charged to filter out unwanted factors. This fee is non-refundable.</b></small></p>
                    </li>
                    
                    <li>
                        <p>
                            <small>
                            ‡§ï‡•É‡§™‡•ç‡§Ø‡§æ ‡§à-‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ ‡§∏‡§π‡•Ä-‡§∏‡§π‡•Ä ‡§¶‡•á‡•§ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§ï‡•Ä ‡§∞‡§∏‡•Ä‡§¶ ‡§î‡§∞ ‡§™‡•ç‡§∞‡§µ‡•á‡§∂ ‡§™‡§§‡•ç‡§∞ ‡§á‡§∏‡•Ä ‡§à-‡§Æ‡•á‡§≤ ‡§™‡§§‡•á ‡§™‡§∞ ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§Ø‡•á‡§ó‡§æ‡•§ <br>
                            Please provide correct email address. Payment receipt and admit card will be sent to this email address.
                            </small>
                        </p>
                    </li>
                    
                    <li>
                        <p>
                            <small>
                                ‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§∏‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§¶‡•á‡§ï‡§∞ ‡§™‡§§‡§æ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§<br>
                                After filling the form, its status can be known by providing Aadhaar number.
                            </small>
                        </p>
                    </li>
                </ul>             
        </div>        
    </div>
    


    <div style="margin-left: 5%;" class="mt-5">
        <h5 style="font-family: 'Jaldi', sans-serif;"><b><u>TAMC 2024</u></b> ‡§ï‡•á ‡§≤‡§ø‡§è ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç : </h5>
        <h5 style="font-family: 'Jaldi', sans-serif;">Fill in the Student's Details for <b><u>TAMC 2024</u></b> : </h5>
    </div>

    <div class="container mb-3 mt-1">

        <form id="myForm">
            <table>
                <tr>
                    <td><label for="name">
                        <p><b>‡§®‡§æ‡§Æ / Name: </b></p>
                    </label></td>
                    <td><input type="text" class="form-control" id="name" name="name" required><br>
                        
                    </td>
                </tr>

                <tr>
                    <td><label for="g_name">
                        <p><b>‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ / Guardian's Name:</b></p>
                    </label></td>
                    <td><input type="text" class="form-control" id="g_name" name="g_name" required><br>
                        
                    </td>
                </tr>
                
                <tr>
                    <td><label for="grade">
                        <p><b>‡§ï‡§ï‡•ç‡§∑‡§æ / Class:</b> </p>
                    </label></td>
                    <td><select name="grade" id="grade">
                        <option value="6" selected>6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                      </select><br>
                        
                    </td>
                </tr>
                <tr>
                    <td><label for="ph">
                        <p><b>‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ / Mobile:</b> </p>
                    </label></td>
                    <td><input type="number" class="form-control" name="ph" id="ph" required><br>
                        
                    </td>
                </tr>
                <tr>
                    <td><label for="ano">
                        <p><b>‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡•¶ / Aadhaar No.:</b> </p>
                    </label></td>
                    <td><input type="number" class="form-control" id="ano" name="ano" required><br>
                        
                    </td>
                </tr>
                <tr>
                    <td><label for="email">
                        <p><b>‡§à-‡§Æ‡•á‡§≤ / E-Mail:</b> </p>
                    </label></td>
                    <td>
                        <input type="email" class="form-control" name="email" id="email" required><br>
                        
                    </td>
                </tr>
                <tr>
                    <td><label for="school">
                        <p><b>‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø / School:</b> </p>
                    </label></td>
                    <td><input type="text" class="form-control" name="school" id="school" required><br></td>
                    <br>
                        
                    </td>
                </tr>
                <tr>
                    <td><label for="address">
                        <p><b>‡§™‡§§‡§æ / Address:</b> </p>
                    </label></td>
                    <td><textarea class="form-control" name="address" name="address" id="address" required></textarea></td>
                    <br>
                        
                    </td>
                </tr>
                <tr>
                    <td><p><b>‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§®‡•á ‡§™‡§ø‡§õ‡§≤‡•á TAMC ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ‡§ì ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§ó ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à?</b></p>
                    <p><b>Have you participated in previous TAMC exams?</b></p>
                    </td>
                    <td>
                        <input type="radio" name="prevAtt" value="y">
                        <label for="html"><p><b>‡§π‡§æ‡§Å / Yes</b></p></label><br>
                        <input type="radio" name="prevAtt" value="n">
                        <label for="html"><p><b>‡§®‡§π‡•Ä‡§Ç / No</b></p></label>
                    </td>
                </tr>
            </table>
            <br>
            <div style="text-align: center;">
                <label for="declar3">
                    <p class="fs-6" style="font-family: 'Lato', sans-serif;">‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ö‡§™‡§®‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¶‡•Ä ‡§ó‡§à ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•Ä ‡§™‡•Å‡§®‡§É ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞ ‡§≤‡•Ä ‡§π‡•à‡•§<br>
                    I have re-checked the information provided by me.
                    </p>
                </label>
                <br>
                <input type="checkbox" name="declar3" required> <br>
                    <br>
                <label for="declar1">
                    <p class="fs-6" style="font-family: 'Lato', sans-serif;">
                    ‡§Æ‡•á‡§∞‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§¶‡•Ä ‡§ó‡§Ø‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Æ‡•á‡§∞‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§∏‡§π‡•Ä ‡§π‡•à‡•§ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§á‡§∏ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§§‡§∞‡§π ‡§ï‡§ø ‡§µ‡§ø‡§∏‡§Ç‡§ó‡§§‡§ø ‡§™‡§æ‡§è ‡§ú‡§æ‡§®‡•á ‡§™‡§∞ ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞‡•Ä ‡§Æ‡•á‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä‡•§ <br>
                        The information given by me is correct according to me. If any discrepancy is found in this regard later, the responsibility will be mine.
                    </p>
                </label>
                <br>
                <input type="checkbox" name="declar1" required> <br>
                <br>
                <div id="fee" style="display: none;">
                    <label for="declar2">
                        <p class="fs-6" style="font-family: 'Lato', sans-serif;">‡§Æ‡•à‡§Ç RMC ‡§ï‡•ã ‚Çπ20 ‡§ï‡•á ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§ï‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§Ö‡§®‡•Å‡§¶‡§æ‡§® ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§µ‡•á‡§ö‡•ç‡§õ‡§æ ‡§∏‡•á ‡§ï‡§∞ ‡§∞‡§π‡§æ/‡§∞‡§π‡•Ä ‡§π‡•Ç‡§Å, ‡§î‡§∞ ‡§∏‡§Æ‡§ù‡§§‡§æ/‡§∏‡§Æ‡§ù‡§§‡•Ä ‡§π‡•Ç‡§Å ‡§ï‡§ø ‡§Ø‡•á ‡§∂‡•Å‡§≤‡•ç‡§ï ‡§µ‡§æ‡§™‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§<br>
                        I am paying the fee of ‚Çπ20 to RMC voluntarily as a grant, and understand that it is non-refundable.
                        </p>
                    </label>
                    <br>
                    <input type="checkbox" name="declar2" id="declar2"> <br>
                </div>
            </div>
            <div style="text-align: center;" class="mt-4">
                <button type="submit" class="btn btn-primary btn-lg btn-block" id="submitButton">Submit üôÇÔ∏è</button>
            </div>
            <div style="text-align: center;" class="mt-2">
                <div class="spinner-border text-primary" role="status" id="spinner" style="visibility: hidden;">
                    <span class="sr-only"> </span>
                </div>
            </div>
        </form>
    </div>

    <div class="mt-5 mb-5">
        <div class="container">
            <form id="appStatus">
                <label><p style="font-family: 'Ubuntu', sans-serif;"><b>‡§Ö‡§™‡§®‡•Ä ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§ú‡§æ‡§®‡•á<br>Know Your Application Status</b></p></label><br>
        
                <input type="number" id="anoEnquiry" placeholder="‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡•¶ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç / Enter Aadhaar No.">
                <button type="submit">Submit</button>
                <div class="spinner-border spinner-border-sm mt-2" role="status" id="spinner2" style="visibility: hidden;">
                    <span class="sr-only">  </span>
                </div>
            </form>
        </div>
    </div>

    <hr class="my-4">

    <div class="container" style="padding-right: 10%; padding-left: 10%;">
        <div style="text-align: center; align-self: center; background-color: #e9ecef; padding: 3%;">

            <p class="fs-5" style="font-family: 'Lato', sans-serif;">Connect With Us</p>
            
                <p class="font-monospace mt-3"><a href="tel:+919472885701">+91 9472885701</a>
                    <img src="{{ url_for('static', filename='/images/telephone-x-fill.svg') }}" style="width:20px;height:20px;">
                    <img src="{{ url_for('static', filename='/images/chat-left-dots-fill.svg') }}" style="width:20px;height:20px;">
                    <img src="{{ url_for('static', filename='/images/whatsapp.svg') }}" style="width:20px;height:20px;">
                    <img src="{{ url_for('static', filename='/images/telegram.svg') }}" style="width:20px;height:20px;">
                </p>
                <p class="font-monospace"><a href="mailto:rmctkg@gmail.com">rmctkg@gmail.com</a>
                    <img src="{{ url_for('static', filename='/images/envelope-at-fill.svg') }}" style="width:20px;height:20px;">
                </p>
                <a href="https://fb.com/rmctkg">
                    <p class="font-monospace">
                        Follow us on <img src="{{ url_for('static', filename='/images/facebook.svg') }}" style="width:20px;height:20px;"> for updates.
                    </p>
                </a>
            
        </div>
    </div>
    <hr class="my-4">



<script>

    async function getStatus(){
        const bell = new Audio("{{ url_for('static', filename='/music/notification.mp3') }}");
        const bell2 = new Audio("{{ url_for('static', filename='/music/notification2.mp3') }}");
        const aNoToBeEnquired = document.getElementById('anoEnquiry').value;
        const getStatusResponse = await fetch('/get_status',{
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
            ano:aNoToBeEnquired
            })
        });

        try {
            if (getStatusResponse.ok){
            const responseData = await getStatusResponse.json();
            bell.play();
            alert(`
            
            ‡§Ü‡§™‡§ï‡§æ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à!
            Your registration has been succesful!
            
            Name: ${responseData.name}
            Guardian's Name: ${responseData.g_name}
            Class: ${responseData.grade}
            Phone: ${responseData.phone}
            Email: ${responseData.email}
            Registered on: ${responseData.time}
            
            `)
            }
            
            else {
                bell2.play();
                alert(`
                ‡§ï‡•ã‡§à ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
                No record found.`)
            }
        } 
        
        catch (error) {
            bell2.play();
            alert("An error occurred: " + error.message);
        }
        
    }

    async function validateAndPay() {
        const bell = new Audio("{{ url_for('static', filename='/music/notification.mp3') }}");
        const bell2 = new Audio("{{ url_for('static', filename='/music/notification2.mp3') }}");

        //Getting the form data.        

        const phone = document.getElementById('ph').value;
        const email = document.getElementById('email').value;
        const ano = document.getElementById('ano').value;
        const name = document.getElementById('name').value;
        const g_name = document.getElementById('g_name').value;
        const grade = document.getElementById('grade').value;
        const school = document.getElementById('school').value;
        const address = document.getElementById('address').value;

        const radioButtons = document.getElementsByName('prevAtt');
        let prevAttV;
        for (const radioButton of radioButtons) {
            if (radioButton.checked) {
                prevAttV = radioButton.value;
                break;
            }
        }

        //Validating Mobile and E-mail from frontend

        const phoneNumber = libphonenumber.parsePhoneNumber(phone, 'IN');

        if (phoneNumber.isValid() && validator.isEmail(email)) {
            console.log("Phone and Email are valid.")
        } else{
            bell2.play();
            alert(`
            ‡§´‡§º‡•ã‡§® ‡§®‡§Ç‡§¨‡§∞ ‡§Ø‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§
            Phone number or Email is invalid.`)
            return -1
        }

        //Validating AAdhar from backend

        const anoValid = await fetch('/validate_data',{
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: new URLSearchParams({
            ano:ano
            })
        });

        if (anoValid.ok){
            bell2.play();
            alert(`
            ‡§á‡§∏ ‡§Ü‡§ß‡§æ‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§ö‡•Å‡§ï‡§æ ‡§π‡•à‡•§
            Aadhar No. has been used.`);
            return -1;
        }

        if (grade === '6') {
            const saveInDatabase = await fetch('/save_in_databse',{
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams({
                            name:name, g_name:g_name, school:school, grade:grade, email:email, phone:phone,
                            address: address, order_id:"no fee", prevAtt:prevAttV, ano:ano
                        })
                    });
                    if (saveInDatabase.ok){
                        console.log("Everything is ok")
                        bell.play();                          
                        alert(`
                            ‡§Ü‡§™‡§ï‡§æ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à!
                            Your registration has been succesful!`);
                        return;
                        }
        }
        
        
        ////////Entering the payment setup/////////

        // Create an order on the server
        const order = await fetch('/create_order', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            }).then(res => res.json());

        const options = {
                key: "{{ key_id }}",
                amount: order.amount,
                currency: order.currency,
                name: "RMC",
                description: "Payment for TAMC - 2024",
                order_id: order.id,
                
                handler: async function (response) {
                    // Send payment details for verification
                            const verifyResponse = await fetch('/verify_payment', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                body: new URLSearchParams({
                                    orderID: order.id,
                                    razorpay_order_id: response.razorpay_order_id,
                                    razorpay_payment_id: response.razorpay_payment_id,
                                    razorpay_signature: response.razorpay_signature
                                })
                            });

                    if (verifyResponse.ok) { // Status code 200-299 indicates success
                        const data = await verifyResponse.json();
                        console.log("Payment verified successfully");
                        const saveInDatabase = await fetch('/save_in_databse',{
                                method: 'POST',
                                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                                body: new URLSearchParams({
                                name:name, g_name:g_name, school:school, grade:grade, email:email, phone:phone,
                                address: address, order_id:order.id, prevAtt:prevAttV, ano:ano
                            })
                        });

                        if (saveInDatabase.ok){
                            console.log("Everything is ok")
                            bell.play();                          
                            alert(`
                            ‡§Ü‡§™‡§ï‡§æ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§∏‡§´‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à!
                            Your registration has been succesful!`);
                        }
                    } else {
                        const errorData = await verifyResponse.json();
                        console.error("Payment verification failed", errorData);
                        // Handle failed verification (e.g., display error to user)
                        bell2.play()
                        alert(`
                        ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§Ö‡§∏‡§´‡§≤ ‡§∞‡§π‡§æ‡•§ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§
                        The Payment was unsuccessful. Please try again.`)
                    }
                    
                },
                method: {
                    upi: true, // Enable UPI
                    card: true, // Enable Cards
                    wallet: true, // Enable Wallets
                    netbanking: true // Enable Net Banking
                },
                prefill: { //We recommend using the prefill parameter to auto-fill customer's contact information especially their phone number
                    "name": name, //your customer's name
                    "email": email,
                    "contact": phone //Provide the customer's phone number for better conversion rates 
                },
                theme: {
                    color: "#528FF0"
                }
            };

        const rzp = new Razorpay(options);
        rzp.open();

        document.getElementById('myForm').reset();
        }
</script>

<script>
    document.getElementById('myForm').addEventListener('submit', async function(event) {
            
            const a = new Audio("{{ url_for('static', filename='/music/click.mp3') }}");
            a.play();
            event.preventDefault(); // Prevent the default submission
            // Show the spinner
            const spinner = document.getElementById('spinner');            
            spinner.style.visibility = "visible";

            const gradeValue = document.getElementById('grade').value;
            
             
            try{
                const validateAndPayStatus = await validateAndPay();
                if (validateAndPayStatus){return;}
            } catch(error){
                console.error("Payment script caused a problem:", error);
                spinner.style.visibility = "hidden";
            }finally{
                spinner.style.visibility = "hidden";
            }
            
        });
    document.getElementById('appStatus').addEventListener('submit', async function(event) {
            const a = new Audio("{{ url_for('static', filename='/music/click.mp3') }}");
            a.play();
            event.preventDefault();
            const spinner = document.getElementById('spinner');            
            spinner2.style.visibility = "visible"; 
            try{
                await getStatus();
            } catch(error){
                console.error("Payment script caused a problem:", error);
                spinner2.style.visibility = "hidden";
            }finally{
                spinner2.style.visibility = "hidden";
            }
            
        });
    document.getElementById('grade').addEventListener('change', function() {
        const gradeValue = this.value; // Get the selected value
        const feeDiv = document.getElementById('fee'); // Get the fee div
        const submitButton = document.getElementById('submitButton');
        const declar2 = document.getElementById('declar2');

        if (gradeValue === '6') {
            declar2.required = false; // Remove required attribute
            feeDiv.style.display = 'none'; // Hide the fee div
            submitButton.innerHTML = "Submit üôÇÔ∏è"; // Update button text
        } else {
            feeDiv.style.display = 'block'; // Show the fee div
            declar2.required = true; // Add required attribute
            submitButton.innerHTML = "Pay ‚Çπ20 and Submit üôÇÔ∏è"; // Update button text
        }
    });

</script>

</body>
</html>